LinkExtractBar.dll


undonut+mod版での修正内容.

2008-07-07
・vs2005/2008 でコンパイル. x64生成追加.

・文字列の終端処理に誤りがあり範囲外のメモリへの書き込みがあったのを修正.

・.dat読込＆ドロップダウンのあたりの調整

・ダウンローダーボタンの順番を変えた.
・win64版ではダウンローダーボタンはiria,irvineのみ.
  ※iria,irvineはwin32,win64共に機能しましたが、
　　DCサクラ,FlushGetはwin32では機能すれど
　　win64版は実行時にインターフェース取得に失敗、
　　NetTransportは版が新しくなりすぎたのか
　　win32,win64共にアウト、なのでした。

・適当にインデント等を付け直し

2008-07-21
・LinkExtructBar.dat(拡張子セット) を pluginフォルダ内の
　直下でなく、その中の LinkExtructBar\ フォルダから読むよう
　に変更。

　同様に ToolBar.bmp(ツールバーアイコン)もLinkExtructBarRes\
　でなく LinkExtructBar\ から読むように変更。

・ダイアログの設定状態を設定ファイルに記憶するようにした。
   (検索文字列,正規表現についての記憶の有無はチェックでon/off)
　ファイルは、LinkExtructBar.dllがおかれたpluginフォルダ中の
　LinkExtructBar\LinkExtructBar.ini です。

・指定したダウンローダーに送るのを1クリックで行う、Sボタンと
　いうのを用意。
　Sボタンにチェックをし、起動したいダウンローダを選択して、
　一旦undonutを終了＆起動すればツールバーにSボタンが増えます。
　※Sボタンのチェックが反映されるのはundonut起動時のみ

・ダウンローダーの呼び出しを本家undonutの LinkExtructor.dll に
　似せてスクリプトを呼べるように変更。
　スクリプト(vba)を用意し、pluginフォルダ内のLinkExtructBar\
　フォルダにいれ、さらに、LinkExtructBar.ini 中の
　[Downloader]
　0=irvine.vba
　1=iria
　のような0-5のいづれかに、スクリプトファイル名を拡張子込みで
　記入のこと。

　※ただし拡張子なしで Irvine,Iria,DcSakura と書いた場合は、
　　もとからある内蔵ルーチンを利用。

　※ボタンは必ず6個表示され、有効な登録のみ名前が出ます。
　　無記名のボタンは押せますが、何もしません。

　※現在、irvine,iriaしかインストールしていないため
　　他のダウンローダが起動できるかどうかは未確認です。


2008-07-25
・リンク一覧での右クリックメニューにゴミ(?)項目がでてたのを削除.
・ダイアログのサイズを設定ファイルに保存するようにした。



その他

・MyDialog.h中のundonut.exeやダウンローダー等のパス等は、
　各自環境で設定しなおしてください。
　wtlやboostのパスをide側でなく、vcproj側のパス設定で行っているので、
　そのへんも、各自のコンパイル環境にあわせて修正してください。

・各種ダウンローダのタイプライブラリのヘッダを入れています。
　必要に応じて作り直したほうがよいでしょうが、いちいちソフトを
　インストールしないといけないのも面倒なので手抜きしてます。

・正規表現ライブラリとして、boost::regexが使われているので
　boostのインストールが必要。現行の ver. 1.35 用にあわせてあります。

　win32版は、コンパイル済みのパッケージが配布されているのでそれでよいけど、
　64ビット版はbjamで用意する必要あり(boost 1.35  2008-07-07 現在).
　コマンドラインで vcvarsx86_amd64.bat を実行しておいて
　> bjam --toolset=msvc-9.0.amd64 runtime-link=static link=static debug release stage
　という感じ。(.amd64とか runtime-linkとかに気づかず、苦労したのでメモ）
　(このプラグインではランタイムもboostも静的リンクしたいのでstatic指定のみ
　だけど必要ならsharedライブラリも生成しておく)
　詳しくはboostのインストールの解説サイトを検索して確認してください。



2008-07-25  +mod
