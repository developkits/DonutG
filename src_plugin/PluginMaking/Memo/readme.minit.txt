元々のミニット氏のreadme.txtです。(適当に横幅調整してます by +mod)
----------------------------------------------------------------------

エクスプローラバープラグインのメモ帳プラグインのソースコードです。
かなりシンプルな構成のプラグインになっています。

このプラグインは Microsoft の VC6 と ATL/WTL ライブラリを 使って作成し
ました。
ATL/WTL は慣れないと使いにくいかもしれませんが、MFC と似ているところも
沢山ありますし、面白いライブラリです。

処理の流れ的には、

unDonut のオプション-プラグイン画面で GetPluginInfo 関数が呼び出される
プラグインが設定されて、 再起動後、 エクスプローラバーのプラグインタブ
から メモ帳-1 を選択するとここで CreateExplorerPane 関数が呼び出される
関数内ではg_Memoなるグローバル変数からウィンドウを作成する。
ちなみに ウィンドウは リソースの IDD_DIALOG_MAIN が そのまま生成される
作成されたウィンドウは unDonut の手に渡り内部に組み込まれる。

エクスプローラバーにあるツールバーから「メニュー」を押してみる。
するとShowExplorerMenu関数が呼び出される。
関数ではリソースのIDR_MENUをロードして表示する。

メニューを選択するとMemo.hにあるメッセージマップからコマンドごとに対応
する関数へと処理が飛ぶ。
例えば「開く」をクリックしたなら

COMMAND_ID_HANDLER(ID_MEMO_FILE_OPEN,OnFileOpen)

の行によって OnFileOpen 関数が呼び出される。
するとエディットボックスに変更を加えた場合は 保存しますか と聞いてきて
その後に「ファイルを開く」ダイアログが出る。


と、こんな感じでプラグインは動作します。
いまいち分かりにくいかも知れませんが、少しずつコードをいじくってみたり、
メッセージボックスを表示させるコードなんかを入れてみると分かりやすいと
思います。



■ビルドについて

まずこのプラグインでは WTL という 標準では入っていないライブラリを使う
ので別途ダウンロードしてきてインストールします。
http://www.microsoft.com/downloads/details.aspx?FamilyID=1be1eb52-aa96-4685-99a5-4256737781c5&DisplayLang
この URL のバージョンは 7.1 ですが動作確認をしたのは 7.0 ですので 問題
があるかもわかりませんが。

次にVCのインクルードファイルの設定をするのですが、
http://home.att.ne.jp/banana/akatsuki/
の サイトの ATL/WTL ページからインストール方法を見れるので、これを参考
にするとわかりやすいと思います。

あとはもうビルドできると思いますが、できなかったら掲示板の方に書き込み
お願いします。
